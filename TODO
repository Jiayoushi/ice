1. Where possible, make functions into member functions
2. Response is maybe a bad idead, why don't you directly send it?
